---
title: "Script for Elsa"
output: html_document
---

```{r setup, include=FALSE}
# install.packages("here")
# install.packages("tidyverse")
# install.packages("rstatix")

library(descr)
library(here)
library(tidyverse)
library(rstatix)
library(sjPlot)
# devtools::install_github("strengejacke/strengejacke
```

## R Markdown

This 

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r, echo= FALSE, message=FALSE}
df1 <- read.csv(here("SATdata.csv"))
df2 <- read.csv(here("BIFdata.csv"))
```

## Including Plots

You can also embed plots, for example:

```{r echo= FALSE, message=FALSE}
df2 <- df2 %>%
  mutate(BIF1 = case_when(Q1 == 1 ~ 1, Q1 == 2 ~ 0)) %>%
  mutate(BIF2 = case_when(Q2 == 2 ~ 1, Q2 == 1 ~ 0)) %>%
  mutate(BIF3 = case_when(Q3 == 1 ~ 1, Q3 == 2 ~ 0)) %>%
  mutate(BIF4 = case_when(Q4 == 1 ~ 1, Q4 == 2 ~ 0)) %>%
  mutate(BIF5 = case_when(Q5 == 1 ~ 1, Q5 == 2 ~ 0)) %>%
  mutate(BIF6 = case_when(Q6 == 2 ~ 1, Q6 == 1 ~ 0)) %>%
  mutate(BIF7 = case_when(Q7 == 1 ~ 1, Q7 == 2 ~ 0)) %>%
  mutate(BIF8 = case_when(Q8 == 1 ~ 1, Q8 == 2 ~ 0)) %>%
  mutate(BIF9 = case_when(Q9 == 2 ~ 1, Q9 == 1 ~ 0)) %>%
  mutate(BIF10 = case_when(Q10 == 1 ~ 1, Q10 == 2 ~ 0)) %>%
  mutate(BIF11 = case_when(Q11 == 2 ~ 1, Q11 == 1 ~ 0)) %>%
  mutate(BIF12 = case_when(Q12 == 2 ~ 1, Q12 == 1 ~ 0)) %>%
  mutate(BIF13 = case_when(Q13 == 1 ~ 1, Q13 == 2 ~ 0)) %>%
  mutate(BIF14 = case_when(Q14 == 1 ~ 1, Q14 == 2 ~ 0)) %>%
  mutate(BIF15 = case_when(Q15 == 2 ~ 1, Q15 == 1 ~ 0)) %>%
  mutate(BIF16 = case_when(Q16 == 1 ~ 1, Q16 == 2 ~ 0)) %>%
  mutate(BIF17 = case_when(Q17 == 2 ~ 1, Q17 == 1 ~ 0)) %>%
  mutate(BIF18 = case_when(Q18 == 2 ~ 1, Q18 == 1 ~ 0)) %>%
  mutate(BIF19 = case_when(Q19 == 2 ~ 1, Q19 == 1 ~ 0)) %>%
  mutate(BIF20 = case_when(Q20 == 1 ~ 1, Q20 == 2 ~ 0)) %>%
  mutate(BIF21 = case_when(Q21 == 2 ~ 1, Q21 == 1 ~ 0)) %>%
  mutate(BIF22 = case_when(Q22 == 2 ~ 1, Q22 == 1 ~ 0)) %>%
  mutate(BIF23 = case_when(Q23 == 1 ~ 1, Q23 == 2 ~ 0)) %>%
  mutate(BIF24 = case_when(Q24 == 1 ~ 1, Q24 == 2 ~ 0)) %>%
  mutate(BIF25 = case_when(Q25 == 2 ~ 1, Q25 == 1 ~ 0))

df2 <- df2 %>%
  mutate(BIF = rowSums(df2[,c('BIF1','BIF2','BIF3','BIF4','BIF5',
                                'BIF6','BIF7','BIF8','BIF9','BIF10',
                                'BIF11','BIF12','BIF13','BIF14','BIF15',
                                'BIF16','BIF17','BIF18','BIF19','BIF20',
                                'BIF21','BIF22','BIF23','BIF24','BIF25')], na.rm=TRUE))
```


```{r  echo= FALSE, message=FALSE}
df1 <- df1 %>%
  mutate(SAT1 = ifelse(SAT_1 == 2, 1, 0)) %>%
  mutate(SAT2 = ifelse(SAT_2 == 2, 1, 0)) %>%
  mutate(SAT3 = ifelse(SAT_3 == 3, 1, 0)) %>%
  mutate(SAT4 = ifelse(SAT_4 == 1, 1, 0)) %>%
  mutate(SAT5 = ifelse(SAT_5 == 3, 1, 0)) %>%
  mutate(SAT6 = ifelse(SAT_6 == 4, 1, 0)) %>%
  mutate(SAT7 = ifelse(SAT_7 == 1, 1, 0)) %>%
  mutate(SAT8 = ifelse(SAT_8 == 1, 1, 0)) %>%
  mutate(SAT9 = ifelse(SAT_9 == 3, 1, 0)) %>%
  mutate(SAT10 = ifelse(SAT_10 == 2, 1, 0))

df1 <-  df1 %>% 
 mutate(SATtotal = rowSums(df1[,c('SAT1','SAT2','SAT3','SAT4','SAT5','SAT6','SAT7','SAT8','SAT9','SAT10')], na.rm=TRUE)) %>% 
 mutate(SATdetail = rowSums(df1[,c('SAT8','SAT10','SAT3','SAT9','SAT7')], na.rm=TRUE)) %>%
 mutate(SATabstract = rowSums(df1[,c('SAT1','SAT2','SAT6','SAT4','SAT5')], na.rm=TRUE))

# df <- df %>% 
#   mutate(Frequency = factor(
#     Frequency,
#     levels = c("Low","high")
#   )) %>% 
#    mutate(Media = factor(
#     Group,
#     levels = c("paper","iPad")
#   ))
```


```{r echo= FALSE, message=FALSE}
#compare the iPad group with paper group regarding SAT scores
model1 <- lm(SATtotal ~ Media+Gender+Age+Time+Media*Time, data = df1)
model2 <- lm(SATdetail ~ Media+Gender+Age+Time+Media*Time, data = df1)
model3 <- lm(SATabstract ~ Media+Gender+Age+Time+Media*Time, data = df1)
```

1) Mean and standard deviations of SATabstract:
```{r echo= FALSE, message=FALSE, eval=FALSE}
descriptive <- df %>% 
    summarise(
    count = n(),
    mean = mean(Time, na.rm = TRUE),
    sd = sd(Time, na.rm = TRUE)
)
```

Mean of the two groups:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped$mean
```

Standard deviation of the two groups:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped$sd
```

2) mean and standard deviations of SATdetail:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped2 <- df %>% 
    group_by(Media) %>%
    summarise(
    count = n(),
    mean = mean(SATdetail, na.rm = TRUE),
    sd = sd(SATdetail, na.rm = TRUE)
)
```

Mean of the two groups:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped2$mean
```

Standard deviation of the two groups:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped2$sd
```

3) mean and standard deviations of SAT total:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped3 <- df %>% 
    group_by(Media) %>%
    summarise(
    count = n(),
    mean = mean(SATtotal, na.rm = TRUE),
    sd = sd(SATtotal, na.rm = TRUE)
)
```

Mean of the two groups:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped3$mean
```

Standard deviation of the two groups:
```{r echo= FALSE, message=FALSE, eval=FALSE}
grouped3$sd
```

t test results for SAT total:
```{r}
summary(model1)
```

t-test result for SAT detail:
```{r}
summary(model2)
```

t-test result for SAT abstract:
```{r}
summary(model3)
```

```{r}
plot_model(model3, type = "pred", terms = c("Time", "Media"))
```


---
title: "Script for Elsa"
output: html_document
---

```{r setup, include=FALSE}
install.packages("here")
install.packages("tidyverse")
install.packages("rstatix")
install.packages("aod")

library(here)
library(tidyverse)
library(rstatix)
library(aod)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r include = FALSE, message=FALSE}
df <- read.csv(here("iPadProjectData.csv"))
```

## Including Plots

You can also embed plots, for example:

```{r include=FALSE, echo=FALSE}
df1 <- df %>% 
  mutate(BIF1 = case_when(Q1 == 1 ~ 1, Q1 == 2 ~ 0)) %>%
  mutate(BIF2 = case_when(Q2 == 2 ~ 1, Q2 == 1 ~ 0)) %>%
  mutate(BIF3 = case_when(Q3 == 1 ~ 1, Q3 == 2 ~ 0)) %>%
  mutate(BIF4 = case_when(Q4 == 1 ~ 1, Q4 == 2 ~ 0)) %>%
  mutate(BIF5 = case_when(Q5 == 1 ~ 1, Q5 == 2 ~ 0)) %>%
  mutate(BIF6 = case_when(Q6 == 2 ~ 1, Q6 == 1 ~ 0)) %>%
  mutate(BIF7 = case_when(Q7 == 1 ~ 1, Q7 == 2 ~ 0)) %>%
  mutate(BIF8 = case_when(Q8 == 1 ~ 1, Q8 == 2 ~ 0)) %>%
  mutate(BIF9 = case_when(Q9 == 2 ~ 1, Q9 == 1 ~ 0)) %>%
  mutate(BIF10 = case_when(Q10 == 1 ~ 1, Q10 == 2 ~ 0)) %>%
  mutate(BIF11 = case_when(Q11 == 2 ~ 1, Q11 == 1 ~ 0)) %>%
  mutate(BIF12 = case_when(Q12 == 2 ~ 1, Q12 == 1 ~ 0)) %>%
  mutate(BIF13 = case_when(Q13 == 1 ~ 1, Q13 == 2 ~ 0)) %>%
  mutate(BIF14 = case_when(Q14 == 1 ~ 1, Q14 == 2 ~ 0)) %>%
  mutate(BIF15 = case_when(Q15 == 2 ~ 1, Q15 == 1 ~ 0)) %>%
  mutate(BIF16 = case_when(Q16 == 1 ~ 1, Q16 == 2 ~ 0)) %>%
  mutate(BIF17 = case_when(Q17 == 2 ~ 1, Q17 == 1 ~ 0)) %>%
  mutate(BIF18 = case_when(Q18 == 2 ~ 1, Q18 == 1 ~ 0)) %>%
  mutate(BIF19 = case_when(Q19 == 2 ~ 1, Q19 == 1 ~ 0)) %>%
  mutate(BIF20 = case_when(Q20 == 1 ~ 1, Q20 == 2 ~ 0)) %>%
  mutate(BIF21 = case_when(Q21 == 2 ~ 1, Q21 == 1 ~ 0)) %>%
  mutate(BIF22 = case_when(Q22 == 2 ~ 1, Q22 == 1 ~ 0)) %>%
  mutate(BIF23 = case_when(Q23 == 1 ~ 1, Q23 == 2 ~ 0)) %>%
  mutate(BIF24 = case_when(Q24 == 1 ~ 1, Q24 == 2 ~ 0)) %>%
  mutate(BIF25 = case_when(Q25 == 2 ~ 1, Q25 == 1 ~ 0)) 
  mutate(BIF = rowSums(df6[,c('BIF1','BIF2','BIF3','BIF4','BIF5',
                                'BIF6','BIF7','BIF8','BIF9','BIF10',
                                'BIF11','BIF12','BIF13','BIF14','BIF15',
                                'BIF16','BIF17','BIF18','BIF19','BIF20',
                                'BIF21','BIF22','BIF23','BIF24','BIF25')], na.rm=TRUE)) %>% 
  convert_as_factor(ID)
```


```{r include=FALSE, echo=FALSE}
df2 <- df1 %>% 
  mutate(SAT1 = ifelse(SAT_1 == 2, 1, 0)) %>%
  mutate(SAT2 = ifelse(SAT_2 == 2, 1, 0)) %>%
  mutate(SAT3 = ifelse(SAT_3 == 3, 1, 0)) %>%
  mutate(SAT4 = ifelse(SAT_4 == 1, 1, 0)) %>%
  mutate(SAT5 = ifelse(SAT_5 == 3, 1, 0)) %>%
  mutate(SAT6 = ifelse(SAT_6 == 4, 1, 0)) %>%
  mutate(SAT7 = ifelse(SAT_7 == 1, 1, 0)) %>%
  mutate(SAT8 = ifelse(SAT_8 == 1, 1, 0)) %>%
  mutate(SAT9 = ifelse(SAT_9 == 3, 1, 0)) %>%
  mutate(SAT10 = ifelse(SAT_10 == 2, 1, 0))

df3 < df2
  mutate(SAT = rowSums(df6[,c('SAT1','SAT2','SAT3','SAT4','SAT5',
                              'SAT6','SAT7','SAT8','SAT9','SAT10')], na.rm=TRUE)) %>% 
    mutate(SATdetail = rowSums(df6[,c('SAT8','SAT10','SAT3','SAT9','SAT7')], na.rm=TRUE)) %>% 
    mutate(SATabstract = rowSums(df6[,c('SAT1','SAT2','SAT6','SAT4','SAT5')], na.rm=TRUE))
```


```{r include=FALSE, echo=FALSE}

#compare the iPad group with paper group regarding SAT scores
model1 <- lm(SAT ~ Group + Frequency, data = df3)
model2 <- lm(BIF ~ Group + Frequency, data = df3)
model1 <- lm(SATdetail ~ Group + Frequency, data = df3)
model1 <- lm(SATabstract ~ Group + Frequency, data = df3)

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
